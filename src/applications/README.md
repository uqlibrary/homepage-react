# Offsite Applications

Our headers and footers can be included in third party sites, such as search.library.uq.edu.au.

Each of the folders in this directory map to one installation set of .js and .css that can be called from another site.

For each install:
- create a sub-folder in /src/applications/ with a name (no spaces) that makes logical sense for the third party site
- within the sub-folder
    - create a custom-styles.scss file containing sass for special styling on the site (the general homepage css will be automatically loaded)
    - create a load.js following the instructions in sample-site/load.js 
      - you can include/not include each of mylibrary button, auth button, footer at all, and connect footer
      - load.js tells the site to insert the react rootpoint and then which of header, footer, etc we want to appear on this site.)
    - (unfortunately the whole set of code has to be included, as I couldnt get it to include a reusable file :( Feel free to have a go!)
- write a readme that explains what site(s) it will apear on and what the allowed site items (login button, footer, etc) are

When webpack runs it will create: 
- an /offSiteApps-js/ folder that contains minimised .js and .css for each application, renamed for the application
- a file, eg primo.js, that matches the name of the application folder hold code generated by webpack that will include the above minimised code

## How to use the created files

Insert the following (example) js into the external site (the external site has to give us a way to do that)
```
<script type="text/javascript" src="../src/applications/sample-site/load.js"></script>
<script src="https://www.library.uq.edu.au/primo.js"></script>
```

## How this is built:
- Webpack looks at the subfolders within /applications/ and creates a .js file with a name matching the subfolder eg creating `/applications/primo/` will mean webpack creates `primo.js`. Lets call this primo.js file the Loader file for the Primo Application.
- For each application subfolder, 
  - Webpack checks for custom-styles.scss and load.js.
  - if they are present, they are minified and written to the dist folder, inside the /offSiteApps-js/ folder in the dist. 
  - they are named for the subfolder, with a hash, 
- Webpack will generate the Loader file to include links to the minified code like the following
  - (there is other code in the file too)
  - the `locator` variable indicates the location of the /offSiteApps-js/ folder.
  - The primo-999.xxx.css files shown come from the custom-styles.scss in the /applications/primo/ folder.
  - The primo-999.xxx.js files shown come from the load.js in the /applications/primo/ folder.
```
insertScript(locator + 'vendor-ff02418c43d0f9e91ff1.min.js');
insertScript(locator + 'main-ff02418c43d0f9e91ff1.min.js');
insertLink(locator + 'main-ff02418c43d0f9e91ff1.min.css');

insertScript(locator + 'primo-ff02418c43d0f9e91ff1.min.js');
insertLink(locator + 'primo-ff02418c43d0f9e91ff1.min.css');
```
In summary:
- `applications/subfolder/custom-styles.scss` becomes `/dist/offSiteApps-js/subfolder-9999-min.css`
- `applications/subfolder/load.js` becomes `/dist/offSiteApps-js/subfolder-9999-min.js`
- `/dist/subfolder.js` is generated to import the above 2 files
